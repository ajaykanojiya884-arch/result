{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Pranay\\\\Desktop\\\\Result_Analysis\\\\frontend\\\\src\\\\pages\\\\Admin\\\\BatchPrint.jsx\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState, useRef } from 'react';\nimport { useParams } from 'react-router-dom';\nimport api from '../../services/api';\nimport { useAuth } from '../../context/AuthContext';\nimport MarksheetTemplate from '../../components/MarksheetTemplate';\nimport html2pdf from 'html2pdf.js';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function BatchPrint() {\n  _s();\n  useAuth();\n  const {\n    division\n  } = useParams();\n  const [studentsData, setStudentsData] = useState([]);\n  const [loading, setLoading] = useState(true);\n  useEffect(() => {\n    async function fetchBatch() {\n      try {\n        // We can reuse the results endpoints. \n        // If we fetch by division, we might get summary list. \n        // We need full details for each student.\n        // /admin/results?division=X usually returns summary objects.\n        // But let's check if the summary objects have enough data.\n        // Based on previous reads, the `/content/admin_results` endpoint logic: \n        // It iterates and builds full data for each student in the division response.\n\n        const res = await api.get('/admin/results', {\n          params: {\n            division\n          }\n        });\n        // The response is an array of full result objects including 'subjects' array\n        setStudentsData(res.data || []);\n      } catch (err) {\n        console.error(\"Batch load failed\", err);\n      } finally {\n        setLoading(false);\n      }\n    }\n    fetchBatch();\n  }, [division]);\n  const handlePrint = () => {\n    window.print();\n  };\n\n  // NOTE: Direct batch PDF DL via html2pdf might be heavy for many pages.\n  // Browser print is safer. But we can add it experimentally.\n  const handleBatchDownload = () => {\n    const element = document.getElementById('batch-container');\n    const opt = {\n      margin: [5, 10, 5, 10],\n      filename: `Batch_Report_${division}.pdf`,\n      image: {\n        type: 'jpeg',\n        quality: 0.98\n      },\n      html2canvas: {\n        scale: 1.5,\n        useCORS: true\n      },\n      jsPDF: {\n        unit: 'mm',\n        format: 'a4',\n        orientation: 'landscape'\n      },\n      pagebreak: {\n        mode: 'css',\n        after: '.page-break'\n      }\n    };\n    html2pdf().set(opt).from(element).save();\n  };\n  if (loading) return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: \"Loading batch data...\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 57,\n    columnNumber: 23\n  }, this);\n  if (!studentsData.length) return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [\"No students found for division \", division]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 58,\n    columnNumber: 36\n  }, this);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"no-print\",\n      style: {\n        padding: 20,\n        background: '#eee',\n        marginBottom: 20\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        children: [\"Batch Print: Division \", division, \" (\", studentsData.length, \" students)\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 63,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: 'flex',\n          gap: 10\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: handlePrint,\n          style: btnStyle,\n          children: \"Print All (Browser)\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 65,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: handleBatchDownload,\n          style: {\n            ...btnStyle,\n            background: '#d32f2f'\n          },\n          children: \"Download All PDF\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 66,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 64,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        style: {\n          fontSize: 13,\n          color: '#666'\n        },\n        children: \"Tip: Use \\\"Print All\\\" and select \\\"Save as PDF\\\" for best results.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 68,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      id: \"batch-container\",\n      children: studentsData.map((student, idx) => /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"page-break\",\n        style: {\n          marginBottom: 0\n        },\n        children: [/*#__PURE__*/_jsxDEV(MarksheetTemplate, {\n          data: student\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 76,\n          columnNumber: 14\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            height: 1,\n            breakAfter: 'page',\n            pageBreakAfter: 'always'\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 78,\n          columnNumber: 14\n        }, this)]\n      }, student.roll_no, true, {\n        fileName: _jsxFileName,\n        lineNumber: 75,\n        columnNumber: 11\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 73,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"style\", {\n      children: `\n        @media print {\n            .no-print { display: none !important; }\n            .page-break { page-break-after: always; break-after: page; }\n            body { margin: 0; padding: 0; }\n        }\n      `\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 61,\n    columnNumber: 5\n  }, this);\n}\n_s(BatchPrint, \"Cwwe2rz8I1sa75c5L4bswFJMzz0=\", false, function () {\n  return [useAuth, useParams];\n});\n_c = BatchPrint;\nconst btnStyle = {\n  padding: '10px 16px',\n  fontSize: 14,\n  fontWeight: 'bold',\n  cursor: 'pointer',\n  background: '#1976d2',\n  color: 'white',\n  border: 'none',\n  borderRadius: 4\n};\nvar _c;\n$RefreshReg$(_c, \"BatchPrint\");","map":{"version":3,"names":["React","useEffect","useState","useRef","useParams","api","useAuth","MarksheetTemplate","html2pdf","jsxDEV","_jsxDEV","BatchPrint","_s","division","studentsData","setStudentsData","loading","setLoading","fetchBatch","res","get","params","data","err","console","error","handlePrint","window","print","handleBatchDownload","element","document","getElementById","opt","margin","filename","image","type","quality","html2canvas","scale","useCORS","jsPDF","unit","format","orientation","pagebreak","mode","after","set","from","save","children","fileName","_jsxFileName","lineNumber","columnNumber","length","className","style","padding","background","marginBottom","display","gap","onClick","btnStyle","fontSize","color","id","map","student","idx","height","breakAfter","pageBreakAfter","roll_no","_c","fontWeight","cursor","border","borderRadius","$RefreshReg$"],"sources":["C:/Users/Pranay/Desktop/Result_Analysis/frontend/src/pages/Admin/BatchPrint.jsx"],"sourcesContent":["\r\nimport React, { useEffect, useState, useRef } from 'react';\r\nimport { useParams } from 'react-router-dom';\r\nimport api from '../../services/api';\r\nimport { useAuth } from '../../context/AuthContext';\r\nimport MarksheetTemplate from '../../components/MarksheetTemplate';\r\nimport html2pdf from 'html2pdf.js';\r\n\r\nexport default function BatchPrint() {\r\n  useAuth();\r\n  const { division } = useParams();\r\n  const [studentsData, setStudentsData] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  \r\n  useEffect(() => {\r\n    async function fetchBatch() {\r\n      try {\r\n        // We can reuse the results endpoints. \r\n        // If we fetch by division, we might get summary list. \r\n        // We need full details for each student.\r\n        // /admin/results?division=X usually returns summary objects.\r\n        // But let's check if the summary objects have enough data.\r\n        // Based on previous reads, the `/content/admin_results` endpoint logic: \r\n        // It iterates and builds full data for each student in the division response.\r\n        \r\n        const res = await api.get('/admin/results', { params: { division } });\r\n        // The response is an array of full result objects including 'subjects' array\r\n        setStudentsData(res.data || []);\r\n      } catch (err) {\r\n        console.error(\"Batch load failed\", err);\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    }\r\n    fetchBatch();\r\n  }, [division]);\r\n\r\n  const handlePrint = () => {\r\n    window.print();\r\n  };\r\n  \r\n  // NOTE: Direct batch PDF DL via html2pdf might be heavy for many pages.\r\n  // Browser print is safer. But we can add it experimentally.\r\n  const handleBatchDownload = () => {\r\n      const element = document.getElementById('batch-container');\r\n      const opt = {\r\n          margin: [5, 10, 5, 10],\r\n          filename: `Batch_Report_${division}.pdf`,\r\n          image: { type: 'jpeg', quality: 0.98 },\r\n          html2canvas: { scale: 1.5, useCORS: true },\r\n          jsPDF: { unit: 'mm', format: 'a4', orientation: 'landscape' },\r\n          pagebreak: { mode: 'css', after: '.page-break' }\r\n      };\r\n      html2pdf().set(opt).from(element).save();\r\n  };\r\n\r\n  if (loading) return <div>Loading batch data...</div>;\r\n  if (!studentsData.length) return <div>No students found for division {division}</div>;\r\n\r\n  return (\r\n    <div>\r\n      <div className=\"no-print\" style={{ padding: 20, background: '#eee', marginBottom: 20 }}>\r\n        <h2>Batch Print: Division {division} ({studentsData.length} students)</h2>\r\n        <div style={{ display: 'flex', gap: 10 }}>\r\n            <button onClick={handlePrint} style={btnStyle}>Print All (Browser)</button>\r\n            <button onClick={handleBatchDownload} style={{ ...btnStyle, background: '#d32f2f' }}>Download All PDF</button>\r\n        </div>\r\n        <p style={{ fontSize: 13, color: '#666' }}>\r\n            Tip: Use \"Print All\" and select \"Save as PDF\" for best results.\r\n        </p>\r\n      </div>\r\n\r\n      <div id=\"batch-container\">\r\n        {studentsData.map((student, idx) => (\r\n          <div key={student.roll_no} className=\"page-break\" style={{ marginBottom: 0 }}>\r\n             <MarksheetTemplate data={student} />\r\n             {/* Force page break after each, except maybe the last one if desired, but consistent break is safer */}\r\n             <div style={{ height: 1, breakAfter: 'page', pageBreakAfter: 'always' }}></div>\r\n          </div>\r\n        ))}\r\n      </div>\r\n      \r\n      <style>{`\r\n        @media print {\r\n            .no-print { display: none !important; }\r\n            .page-break { page-break-after: always; break-after: page; }\r\n            body { margin: 0; padding: 0; }\r\n        }\r\n      `}</style>\r\n    </div>\r\n  );\r\n}\r\n\r\nconst btnStyle = {\r\n  padding: '10px 16px', \r\n  fontSize: 14, \r\n  fontWeight: 'bold',\r\n  cursor: 'pointer',\r\n  background: '#1976d2',\r\n  color: 'white',\r\n  border: 'none',\r\n  borderRadius: 4\r\n};\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}